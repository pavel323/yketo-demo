{"version":3,"file":"next-redux-saga.umd.js","sources":["../index.js"],"sourcesContent":["import React, {Component} from 'react'\nimport {END} from 'redux-saga'\n\nfunction hoc(config) {\n  return BaseComponent => {\n    class WrappedComponent extends Component {\n      static async getInitialProps(props) {\n        const {isServer, store} = props.ctx\n\n        let pageProps = {}\n        if (BaseComponent.getInitialProps) {\n          pageProps = await BaseComponent.getInitialProps(props)\n        }\n\n        // Keep saga running on the client (async mode)\n        if (config.async && !isServer) {\n          return pageProps\n        }\n\n        // Force saga to end in all other cases\n        store.dispatch(END)\n        await store.sagaTask.done\n\n        // Restart saga on the client (sync mode)\n        if (!isServer) {\n          store.runSagaTask()\n        }\n\n        return pageProps\n      }\n\n      render() {\n        return <BaseComponent {...this.props} />\n      }\n    }\n\n    return WrappedComponent\n  }\n}\n\nfunction withReduxSaga(arg) {\n  const defaultConfig = {async: false}\n\n  if (typeof arg === 'function') {\n    return hoc(defaultConfig)(arg)\n  }\n\n  return hoc({...defaultConfig, ...arg})\n}\n\nexport default withReduxSaga\n"],"names":["hoc","config","WrappedComponent","React","props","ctx","isServer","store","BaseComponent","getInitialProps","async","pageProps","dispatch","END","sagaTask","done","runSagaTask","Component","withReduxSaga","arg","defaultConfig"],"mappings":";;;;;;;;;;;;;;;;;;;;;AAAA,AAGA,SAASA,GAAT,CAAaC,MAAb,EAAqB;SACZ,yBAAiB;QAChBC,gBADgB;;;;;;;;;;;iCA2BX;iBACAC,6BAAC,aAAD,EAAmB,KAAKC,KAAxB,CAAP;;;;;iFA1B2BA,KAFT;;;;;;;iCAGQA,MAAMC,GAHd,EAGXC,QAHW,cAGXA,QAHW,EAGDC,KAHC,cAGDA,KAHC;6BAAA,GAKF,EALE;;yBAMdC,cAAcC,eANA;;;;;;2BAOED,cAAcC,eAAd,CAA8BL,KAA9B,CAPF;;;6BAAA;;;0BAWdH,OAAOS,KAAP,IAAgB,CAACJ,QAXH;;;;;qDAYTK,SAZS;;;;;0BAgBZC,QAAN,CAAeC,aAAf;;2BACMN,MAAMO,QAAN,CAAeC,IAjBH;;;;;wBAoBd,CAACT,QAAL,EAAe;4BACPU,WAAN;;;qDAGKL,SAxBW;;;;;;;;;;;;;;;;;;;MACSM,eADT;;WAgCff,gBAAP;GAhCF;;;AAoCF,SAASgB,aAAT,CAAuBC,GAAvB,EAA4B;MACpBC,gBAAgB,EAACV,OAAO,KAAR,EAAtB;;MAEI,OAAOS,GAAP,KAAe,UAAnB,EAA+B;WACtBnB,IAAIoB,aAAJ,EAAmBD,GAAnB,CAAP;;;SAGKnB,iBAAQoB,aAAR,EAA0BD,GAA1B,EAAP;;;;;;;;;"}